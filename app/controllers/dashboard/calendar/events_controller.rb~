class Dashboard::Calendar::EventsController < ApplicationController
  include EventHashHelper
  def edit
    @event = Event.find(params[:id])
  end

  def new

  end

  def show
    @event = Event.find(params[:id])
    if request.xhr?
      render :partial => 'show', :object=> @event 
    end
  end

  def create
    eventhash = self.setUpEventHash
    if (!eventhash)
      flash[:notice] = "Invalid Date selected."
      redirect_to new_dashboard_calendar_event_path
      return
    end

    if eventhash[:end_at] <= eventhash[:start_at]
      flash[:notice] = "Invalid End Date selected."  
      redirect_to new_dashboard_calendar_event_path
      return
    end
    @event = Event.create!(eventhash)
    flash.keep[:notice] = "#{@event.name} was successfully created."
    redirect_to dashboard_calendar_path
  end

  def update
    @event = Event.find params[:id]
    @event.update_attributes!(params[:event])
    flash[:notice] = "#{@event.name} was successfully updated."
    redirect_to dashboard_calendar_event_path(@event)
  end

  def destroy
    @event = Event.find(params[:id])
    @event.destroy
    flash[:notice] = "event '#{@event.name}' deleted."
    redirect_to dashboard_calendar_path
  end
  
end
